{% extends 'layout.html' %}
{% block title %} View kits {% endblock %}
{% block head %}
<script src='{{ url_for("static", filename="scripts/route_button.js") }}'></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
{% endblock %}

{% block main %}
<div class='content-section'>
    <legend class='border-bottom mb-4'>
      Your kits
        <button type='button' class='route-button btn btn-outline-primary float-right' id='create-button'>Create a new kit</button>
    </legend>

    {% if not userKits.count() %}
    <h3>You haven't created any kits yet.</h3>
    {% endif %}

    {% for kit in userKits %}
        <article class='media content-section'>
          <a href='{{ url_for("account", username=kit.owner.username) }}'>
            <img class='rounded-circle article-img' src='{{ url_for("static", filename="/images/profile_pictures/" + kit.owner.pfp_file) }}' height='50px'>
          </a>
          <div class='media-body'>
            <div class='article-metadata'>
              <a class='mr-2' href='{{ url_for("account", username=kit.owner.username) }}'>{{ kit.owner.username }}</a>
              <small class='text-muted'>{{ kit.category }}</small>
              {% for tag in kit.tags %}
              <span class='badge badge-pill badge-primary'>{{ tag.tag }}</span>
              {% endfor %}
            </div>
            <h2><a class='article-title' href='{{ url_for("view_kit", kitID=kit.id) }}'>{{ kit.title }}</a></h2>
          </div>
          <button type='button' class='route-button btn btn-outline-primary float-right mr-2' id='{{ kit.id }}/edit-button'><i class='fa fa-edit'></i></button>
          <button type='button' class='btn btn-outline-danger float-right mr-2' data-toggle="modal" data-target="#deleteKitModal"><i class='fa fa-trash'></i></button>

          <div class="modal fade" id="deleteKitModal" tabindex="-1" role="dialog" aria-labelledby="deletKitModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="deleteKitModalLabel">Confirm deletion</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  Are you sure you want to delete this kit? You won't be able to recover it.
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                  <form action='{{ url_for("delete_kit", kitID=kit.id) }}' method='post'>
                    <button class='btn btn-danger' type='submit'>Confirm</button>
                  </form>
                </div>
              </div>
            </div>
          </div>

        </article>
    {% endfor %}
</div>
{% endblock %}